!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).galanga={})}(this,function(e){"use strict";function a(e){for(var t=1;t<arguments.length;t++){var r,n=arguments[t];for(r in n)e[r]=n[r]}return e}var t=function t(s,o){function r(e,t,r){if("undefined"!=typeof document){"number"==typeof(r=a({},o,r)).expires&&(r.expires=new Date(Date.now()+864e5*r.expires)),r.expires&&(r.expires=r.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var n,i="";for(n in r)r[n]&&(i+="; "+n,!0!==r[n])&&(i+="="+r[n].split(";")[0]);return document.cookie=e+"="+s.write(t,e)+i}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],r={},n=0;n<t.length;n++){var i=t[n].split("="),o=i.slice(1).join("=");try{var a=decodeURIComponent(i[0]);if(r[a]=s.read(o,a),e===a)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){r(e,"",a({},t,{expires:-1}))},withAttributes:function(e){return t(this.converter,a({},this.attributes,e))},withConverter:function(e){return t(a({},this.converter,e),this.attributes)}},{attributes:{value:Object.freeze(o)},converter:{value:Object.freeze(s)}})}({read:function(e){return(e='"'===e[0]?e.slice(1,-1):e).replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),t={getItem:t.get,setItem:t.set,removeItem:t.remove,keys(){var t=document.cookie.replace(/((?:^|\s*;)[^]+)(?=;|$)|^\s*|\s*(?:[^;]*)?(?:|$)/g,"").split(/\s*(?:[^;]*)?;\s*/);for(let e=0;e<t.length;e++)t[e]=decodeURIComponent(t[e]);return t},clear(){var t=this.keys();for(let e=0;e<t.length;e++)this.removeItem(t[e])}};const o="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function r(e){return!!(null==e||""===e||"number"==typeof e&&isNaN(e))||!(!Array.isArray(e)||0!==e.length)}function i(e){return!r(e)}var n={getQuery(e){e=window.location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==e||e.length<1?"":e[1]},getHash(e){e=window.location.hash.match(new RegExp("[#&]"+e+"=([^&]+)","i"));return null==e||e.length<1?"":e[1]},getPath(e=!1){let t;return t=e?(t=window.location.href,e=window.location.origin,t.replace(e,"")):window.location.pathname},setPath(e){try{return window.history.pushState({},"",e),!0}catch(e){return console.log(e),!1}},setHash(e){try{return window.location.hash=e,!0}catch(e){return console.log(e),!1}},setQuery(e,t){try{var r=new URLSearchParams(window.location.search);return r.set(e,t),window.history.pushState({},"",window.location.pathname+"?"+r.toString()),!0}catch(e){return console.log(e),!1}}};const s={check:()=>"Notification"in window&&("granted"===Notification.permission||"denied"!==Notification.permission&&null),request:async()=>{var e=s.check();return null==e?"granted"===await Notification.requestPermission():e}},c={check:async()=>{if(!("Clipboard"in window))return!1;try{return await f("clipboard-write")}catch{return!1}},request:async()=>{let e=await c.check();if(null!==e)return!0===e;try{return await navigator.clipboard.readText(),!0}catch{return!0===(e=await c.check())}}},u={check:async()=>{if(!("geolocation"in navigator))return!1;try{return await f("geolocation")}catch{return!1}},request:async()=>{let e=await u.check();if(null!==e)return!0===e;try{return await navigator.geolocation.getCurrentPosition(()=>{}),!0}catch{return!0===(e=await u.check())}}},l={check:async()=>{if(!("mediaDevices"in navigator))return!1;try{return await f("camera")}catch{return!1}},request:async()=>{let e=await l.check();if(null!==e)return!0===e;try{return await navigator.mediaDevices.getUserMedia({video:!0}),!0}catch{return!0===(e=await l.check())}}};async function f(e){e=await navigator.permissions.query({name:e});return"granted"===e.state||"prompt"===e.state&&null}function d(t,e){let r={};return e.forEach(e=>{t.hasOwnProperty(e)&&(r[e]=t[e])}),r}const h={read:async(e=!0)=>{return 1==await c.request()?e?await navigator.clipboard.readText():await navigator.clipboard.read():null},write:async e=>{if(1!=await c.request())return!1;try{return"string"==typeof e?await navigator.clipboard.writeText(e):await navigator.clipboard.write(e),!0}catch(e){return console.error(e),!1}}};function p(e,t=2){t=Math.pow(10,t);return(Math.floor(e*t)/t).toString()}e.afterTime=function(e,t="Date"){let r;if("number"==typeof e)r=new Date(Date.now()+e);else if("string"==typeof e)r=new Date(Date.now()+Number(e));else{if(!(e instanceof Date))throw new Error("输入参数类型错误");r=new Date(Date.now()+e.getTime())}return"date"===t.toLowerCase()?r:"number"===t.toLowerCase()?r.getTime():"string"===t.toLowerCase()?r.toISOString():void 0},e.arrayFilterUniqueItem=function(e){var t=[],r=new Set;for(const i of e){var n=JSON.stringify(i);r.has(n)||(t.push(i),r.add(n))}return t},e.cameraPermission=l,e.checkDeviceType=function(e=["os","browser","device","platform"]){const t=navigator.userAgent;let r=!1,n;"string"==typeof e&&(r=!0,e=[e],n=e[0]);var i={os:e.includes("os")?/Windows/i.test(t)?"windows":/Macintosh/i.test(t)?"mac":/Linux/i.test(t)?"linux":/HarmonyOS/i.test(t)?"harmonyos":/Android/i.test(t)?"android":/iPhone/i.test(t)||/iPod/i.test(t)||/iPad/i.test(t)?"ios":"other":"",browser:e.includes("browser")?/MicroMessenger/i.test(t)?"wechat":/QQ/i.test(t)?"qq":/Alipay/i.test(t)?"alipay":/Weibo/i.test(t)?"weibo":/DingTalk/i.test(t)?"dingtalk":/Taobao/i.test(t)?"taobao":/Tmall/i.test(t)?"tmall":/Edge/i.test(t)?"edge":/Opera/i.test(t)?"opera":/360SE/i.test(t)?"360":/UCBrowser/i.test(t)?"uc":/Baidu/i.test(t)?"baidu":/Chrome/i.test(t)?"chrome":/Safari/i.test(t)?"safari":/Firefox/i.test(t)?"firefox":/MSIE/i.test(t)?"ie":"other":"",device:e.includes("device")?function(){var e=t.match(/(iPad).*OS\s([\d_]+)|(iPod)(.*OS\s([\d_]+))?|(iPhone\sOS)\s([\d_]+)|(Android);?[\s\/]+([\d.]+)?|(Windows\sPhone)\sOS\s([\d.]+)|(Windows\sNT)\s([\d.]+)|(Macintosh);.*Mac\sOS\sX\s([\d_]+)|(Linux)\s?([\d.]+)?/);if(e){if(e[1]||e[3]||e[5])return"tablet";if(e[7]||e[9]||e[11])return"mobile";if(e[13]||e[15]||e[17])return"pc"}return"other"}():"",platform:e.includes("platform")?"web":""};return!0===r?i[n]:d(i,e)},e.checkEmail=function(e){return/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/.test(e)},e.checkNotNull=i,e.checkNull=r,e.checkPassword=function(e,{minLength:t=8,maxLength:r=16,types:n=["number","lowercase","uppercase","special"],minTypes:i=2,maxTypes:o=4}={}){if(e.length<t||e.length>r)return!1;let a=0;return-1<n.indexOf("number")&&/\d/.test(e)&&a++,-1<n.indexOf("lowercase")&&/[a-z]/.test(e)&&a++,-1<n.indexOf("uppercase")&&/[A-Z]/.test(e)&&a++,-1<n.indexOf("special")&&/[~!@#$%^&*()_+`\-={}:";'<>?,.\/]/.test(e)&&a++,!(a<i||a>o)},e.clipboard=h,e.clipboardPermission=c,e.decode62=function(e){"number"==typeof e&&(e=e.toString());var t=o.length,r=e.length;let n=0,i=0;for(;n<r;)i+=Math.pow(t,n++)*o.indexOf(e.charAt(r-n)||"0");return Number(i)},e.encode62=function(e){var t=o.length,r=[];do{var n=e%t;e=(e-n)/t,r.unshift(o[n])}while(e);return r.join("")},e.filterUniqueByProperty=function(e,n){return e.filter((t,e,r)=>{return-1===r.slice(e+1).findIndex(e=>e[n]===t[n])})},e.formatBytes=function e(t,{decimals:r=1,from:n="B",to:i="auto"}={}){var o;return t<0?"-"+e(-t,{decimals:r,from:n,to:i}):0===t?"0 B":(r=r<0?0:r,o=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],n="auto"===n?Math.floor(Math.log(t)/Math.log(1024)):o.indexOf(n),t/=Math.pow(1024,n),"auto"===i?(n=Math.floor(Math.log(t)/Math.log(1024)),parseFloat((t/Math.pow(1024,n)).toFixed(r))+" "+o[n]):parseFloat(t.toFixed(r))+" "+i)},e.formatNumber=p,e.formatPercent=function(e=0,t=100,r=1){return p(e/t*100,r)+"%"},e.getFileExtFromString=function(e){return(e=e.split("."))[e.length-1]},e.getFileNameFromURL=function(e){return(e=e.split("/"))[e.length-1]},e.getPreURL=function(){var e=window.history.state.back;return i(e)?e:document.referrer},e.info={name:"galanga",author:"censujiang",type:"main"},e.localCookie=t,e.locationPermission=u,e.notificationPermission=s,e.shakeObject=d,e.share=function({content:e="none",title:t="galanga",url:r="",files:n=[]}={}){const i=t+" "+e+"\n"+r;async function o(){c.request(),1==await h.write(i)?alert("已将分享内容复制到剪切板。"):prompt("请您复制以下内容并手动分享。",i)}navigator.share?(navigator.canShare&&navigator.canShare({files:n})||(n=[]),navigator.share({title:t,text:e,url:r,files:n}).catch(e=>{console.warn("Not support navigator share",e),o()})):o()},e.sleep=t=>new Promise(e=>setTimeout(e,t)),e.spliceSiteTitle=function({title:e="none",siteName:t="Galanga",separator:r="-",reverse:n=!1}={}){return r=" "+r+" ",n?t+r+e:e+r+t},e.strLength=function(t){let r=0;if(t){var n=t.length;for(let e=0;e<n;e++)255<t.charCodeAt(e)?r+=2:r++;return r}return 0},e.updateObjectFromImport=function e(t,r){for(var n in r)t.hasOwnProperty(n)&&("object"==typeof r[n]&&"object"==typeof t[n]?e(t[n],r[n]):i(t[n])&&(r[n]=t[n]));return r},e.url=n});
